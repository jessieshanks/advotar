(function() {function l(a,b){this.C=a;this.namespace=void 0===b?null:b}l.prototype.setItem=function(a,b){try{return this.C.setItem(null==this.namespace?a:this.namespace+"."+a,b),!0}catch(c){return!1}};l.prototype.getItem=function(a){return this.C.getItem(null==this.namespace?a:this.namespace+"."+a)};l.prototype.removeItem=function(a){this.C.removeItem(null==this.namespace?a:this.namespace+"."+a)};function p(){this.xhr=null}p.prototype.cancel=function(){this.xhr&&(this.xhr.abort(),this.xhr=null)};p.prototype.finish=function(){this.xhr=null};function r(a){this.B=a&&a.analyticsContext||null;this.o=a&&a.authToken||null;this.u=a&&a.authzToken||null;this.D=a&&a.brandRestriction||null;this.F=a&&a.buildName||null;this.G=a&&a.buildSha||null;this.i=a&&a.csrfTokens||{};this.A=a&&a.serverRoot||null;this.L=!!this.A;this.N=this.A?this.A+"/_ajax":"/_ajax"}
r.prototype.copy=function(a){var b={analyticsContext:this.B,authToken:this.o,authzToken:this.u,brandRestriction:this.D,buildName:this.F,buildSha:this.G,serverRoot:this.A},c;for(c in a)b[c]=a[c];if(null===a.csrfTokens)c=null;else{c={};a=a.csrfTokens||{};for(var d in this.i)c[d]=this.i[d];for(d in a)c[d]=a[d]}b.csrfTokens=c;return new r(b)};function t(a){var b=a.indexOf("/",1);return-1==b?a:a.substring(0,b)}r.prototype.get=function(a,b){var c=new p;this.send("GET",a,null,!0,null,c,null,b);return c};
r.prototype.post=function(a,b,c,d){var f=new p;u(this,"POST",a,b,!0,0,f,c,d);return f};function u(a,b,c,d,f,h,g,m,n){var k=t(c);if(k in a.i){var e=a.i[k];a.send(b,c,d,f,e,g,m,function(q,y){418==q&&1>h?(a.i[k]==e&&delete a.i[k],u(a,b,c,d,f,h+1,g,m,n)):(n&&n(q,y),g.finish())})}else a.send("GET","/csrf"+k,null,f,null,g,null,function(e,y){200==e?(k in a.i||(a.i[k]=String(y)),u(a,b,c,d,f,h,g,m,n)):(n(e,null),g.finish())})}
r.prototype.send=function(a,b,c,d,f,h,g,m){function n(){4==e.readyState&&k()}function k(){var a,b,c;try{a=e.status;var d,f;try{d=e.getResponseHeader("X-Canva-Auth")}catch(g){}try{f=e.getResponseHeader("X-Canva-Authz")}catch(g){}d&&(q.o="!"!=d?d:null);f&&(q.u="!"!=f?f:null);b=e.responseText}catch(g){if(g.message&&g.message.match(/c00c023f/))a=0,b="";else throw h.finish(),g;}b=b&&b.trim?b.trim():"";d=b.substring(0,20);if(0<d.length){if("'\"])}while(1);\x3c/x\x3e//"!=d){m(500,null);h.finish();return}b=
b.substring(20);try{c=JSON.parse(b)}catch(g){m(500,null);h.finish();return}}else c=null;m(a,c);h.finish()}b=this.N+b;var e=h.xhr=new XMLHttpRequest,q=this;e.open(a,b,d);this.L&&(e.withCredentials=!0);"GET"!=a&&f&&e.setRequestHeader("X-Csrf-Token",f);this.B&&e.setRequestHeader("X-Canva-Analytics",this.B);this.o&&e.setRequestHeader("X-Canva-Auth",this.o);this.u&&e.setRequestHeader("X-Canva-Authz",this.u);this.D&&e.setRequestHeader("X-Canva-Brand",this.D);this.F&&e.setRequestHeader("X-Canva-Build-Name",
this.F);this.G&&e.setRequestHeader("X-Canva-Build-Sha",this.G);null===c?a=null:"object"==typeof c&&"undefined"!==typeof Blob&&c instanceof Blob?(e.setRequestHeader("Content-Type",c.type),g&&e.upload.addEventListener("progress",g,!1),a=c):(e.setRequestHeader("Content-Type","application/json;charset\x3dUTF-8"),a=JSON.stringify(c));d?(e.onreadystatechange=n,e.send(a)):(e.send(a),k())};"undefined"!=typeof exports&&(exports.O=r);function v(){this.view=null}v.prototype.l=function(a){var b=$("body");this.view&&(this.view.remove(),this.view=null,b.removeClass("systemAlertVisible"));if(a){var c=this;b.addClass("systemAlertVisible");this.view=new w;this.view.render(a).$el.appendTo(b);this.view.once("hide",function(){return c.trigger("hide")})}};v.prototype.on=Backbone.Events.on;v.prototype.off=Backbone.Events.off;v.prototype.trigger=Backbone.Events.trigger;function w(){}w=Backbone.View.extend({className:"systemAlert"});
w.prototype.events=function(){var a=this;return{"click .systemAlertHide":function(){return a.trigger("hide")}}};w.prototype.render=function(a){this.$el.html(this.template({message:a}));return this};w.prototype.template=_.template('\x3cp class\x3d"systemAlertMessage"\x3e\x3c%- message %\x3e\x3c/p\x3e\x3ca class\x3d"systemAlertHide" href\x3d"#"\x3eOK, hide\x3c/a\x3e');function x(){}x.prototype.now=function(){return Date.now()};var z=new x;var B=new A;function A(){}A.prototype.setInterval=function(a,b){return window.setInterval(a,b)};A.prototype.clearInterval=function(a){window.clearInterval(a)};A.prototype.setTimeout=function(a,b){return window.setTimeout(a,b)};A.prototype.clearTimeout=function(a){window.clearTimeout(a)};A.prototype.requestAnimationFrame=function(a){return window.requestAnimationFrame(a)};A.prototype.cancelAnimationFrame=function(a){window.cancelAnimationFrame(a)};function C(a,b,c,d,f){var h=this;this.view=a;this.j=this.message=null;this.H=c;this.K=b;this.J=d;this.I=f;this.v=null;this.view.on("hide",function(){if(h.message){var a=h.H,b="acknowledged."+h.message;try{var c=JSON.stringify(h.I.now());a.setItem(b,c)}catch(d){}h.l(null)}})}function D(a){a.j&&a.j.cancel();a.j=a.K.get("/alerts/active",function(b,c){a.j=null;200===b&&a.l(c)})}
C.prototype.start=function(a){var b=this;null==this.v&&(this.l(void 0!==a?a:null),this.v=this.J.setInterval(function(){return D(b)},3E5))};C.prototype.stop=function(){null!=this.j&&(this.j.cancel(),this.j=null);null!=this.v&&this.J.clearInterval(this.v)};C.prototype.l=function(a){if(a){var b;try{var c=this.H.getItem("acknowledged."+a);b=null!==c?JSON.parse(c):null}catch(d){b=null}if(null!=b&&864E5>this.I.now()-b)return}this.message=a;this.view.l(a)};$(function(){var a;if(window.localStorage)a=new l(window.localStorage,"SystemAlertController");else throw Error("ClientStore: localStorage is not defined on window, likely an unsupported browser");(new C(new v,new r(window.httpServiceConfig),a,B,z)).start(window.systemAlert)});})();
